<switch name="Think.session.admin.id_level" >
<case value="5"><include file="Public/header" /></case>
<case value="2"><include file="Public/headerr" /></case>
<default />默认情况
</switch>
<style type="text/css">
.column-title{
  text-align: center;
}
</style>
<div class="right_col" role="main">
<div class="row">
              <div class="col-md-4 col-sm-6 col-xs-12">
                <div class="x_panel fixed_height_320">
                  <div class="x_title">
                    <h2>科室评分情况 <small>| {$Think.session.admin.user_department} |</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                          <li><a href="#">Settings 1</a>
                          </li>
                          <li><a href="#">Settings 2</a>
                          </li>
                        </ul>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content" style="overflow:auto;height:250px;">

                    <volist name="off" id="v" key="j">
                    <div class="widget_summary">
                      <div class="w_left w_25">
                        <span>{$v}</span>
                      </div>
                      <div class="w_center w_55">
                        <div class="progress">
                          <div class="progress-bar bg-green" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: {$peosum[$j-1]}%;">
                            <span class="sr-only">60% Complete</span>
                          </div>
                        </div>
                      </div>
                      <div class="w_right w_20">
                        <span>{$peosum[$j-1]}%</span>
                      </div>
                      <div class="clearfix"></div>
                    </div>
                    </volist>

                  </div>
                </div>
              </div>
              <div class="col-md-4 col-sm-6 col-xs-12">
                <div class="x_panel fixed_height_320">
                  <div class="x_title">
                    <h2>未评分人名单 <small>| {$Think.session.admin.user_department} |</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                          <li><a href="#">Settings 1</a>
                          </li>
                          <li><a href="#">Settings 2</a>
                          </li>
                        </ul>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content" style="overflow:auto;height:250px;">
                  <volist name="off" id="v" key="j">
                    <div class="widget_summary">
                      <div class="w_left w_25">
                        <span>{$v}</span>
                      </div>
                      <div class="w_center w_55">
                        <div class="" style="width:280px;overflow:auto;height:100%;border-bottom:solid #FFFFFF 3px;">           
                          <label>{$peodiff[$j-1]}</label> 
                        </div>
                      </div>
                      
                    </div>
                    </volist>
                  </div>
                </div>
              </div>

              <div class="col-md-4 col-sm-6 col-xs-12">
                <div class="x_panel fixed_height_320">
                  <div class="x_title">
                    <h2>总体评分情况 <small>| {$Think.session.admin.user_department} |</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                          <li><a href="#">Settings 1</a>
                          </li>
                          <li><a href="#">Settings 2</a>
                          </li>
                        </ul>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                    <div class="dashboard-widget-content">
                     
                      <div class="sidebar-widget" style="width:100%;height:220px;margin-top:0%;">
                        <h4>总评分人数情况</h4><input type="hidden" value="{$count}" id="count">
                        <canvas width="150" height="80" id="foo" class="" style="width: 240px; height: 150px;"></canvas>
                        <div class="goal-wrapper">
                          <span id="gauge-text" class="gauge-value pull-left">{$count}</span>
                          <span class="gauge-value pull-left">%</span>
                          <span id="goal-text" class="goal-value pull-right">100%</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              
              </div>
<div class="row">
<form id="subform" action="{:U('Performance/daihao1')}" method="post" class="form-horizontal">
  <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                  <div class="x_title">
                    <h2>{$Think.session.admin.user_department}:{$Think.session.admin.year}年{$month}月 正式版成绩</h2>
                    <input type="hidden" name="month" value="{$month}">
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                          <li><a href="#">Settings 1</a>
                          </li>
                          <li><a href="#">Settings 2</a>
                          </li>
                        </ul>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>

                  <div class="x_content">

                    <div class="table-responsive"  style="">
                      <table class="table table-striped jambo_table bulk_action" style="text-align:center;">
                        <thead>
                          <tr class="headings">
                            <th class="column-title" width="5%">序号</th>
                            <th class="column-title" width="5%">工号</th>
                            <th class="column-title" style="text-align:center;" width="5%">姓名</th>
                            <th class="column-title" width="8%">部门</th>
                            <th class="column-title" width="8%">科室</th>
                            <th class="column-title" width="8%">职位</th>
                            <th class="column-title" width="10%" style="text-align:left;">岗位</th>
                            <th class="column-title"width="8%">总分</th>
                            <th class="column-title" style="width:10%;text-align:left;">评价人</th>
                            <th class="column-title" style="width:10%;">最终评价人 </th>
                          </tr>
                        </thead>
                        <notempty name="id">

                        <tbody>
                        <volist name="data[chief]" id="vo">
                          <tr class="even pointer">
                          <td class=" ">
                              <label>
                                {$i}
                              </label>
                            </td>
                          <td class=" ">
                              <label>
                                {$vo.id_employee}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.name}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.department}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.office}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                <switch name="vo.id_level">
                                <case value="3">科员</case>
                                <case value="4">科长</case>
                                <case value="7">VSE</case>
                                <case value="8">项目经理</case>
                                </switch>
                              </label>
                            </td>
                            <td class=" " style="text-align:left;">
                              <label>
                                {$vo.job}
                              </label>
                            </td>
                             <td class=" ">
                              <label>
                                {$vo.grade_total}
                              </label>
                            </td>
                            <td class=" " style="text-align:left;">
                              <label>
                                {$vo.grade_leader}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.grade_last}
                              </label>
                            </td>
                          </tr>
                        </volist>
                        <volist name="data[staff]" id="vo">
                          <tr class="even pointer">
                          <td class=" ">
                              <label>
                                {$i}
                              </label>
                            </td>
                          <td class=" ">
                              <label>
                                {$vo.id_employee}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.name}
                              </label>
                            </td>
                            
                            <td class=" ">
                              <label>
                                {$vo.department}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.office}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                <switch name="vo.id_level">
                                <case value="3">科员</case>
                                <case value="4">科长</case>
                                <case value="7">VSE</case>
                                <case value="8">项目经理</case>
                                </switch>
                              </label>
                            </td>
                            <td class=" " style="text-align:left;">
                              <label>
                                {$vo.job}
                              </label>
                            </td>
                             <td class=" ">
                              <label>
                                {$vo.grade_total}
                              </label>
                            </td>
                            <td class=" " style="text-align:left;">
                              <label>
                                {$vo.grade_leader}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.grade_last}
                              </label>
                            </td>
                          </tr>
                        </volist>
                        </tbody>
                        
                        <else/>

                        <tbody>
                        <volist name="data[chief]" id="vo">
                          <input type="hidden" name="chief[{$i}][id_employee]"   value="{$vo.chief_id}">
                          <input type="hidden" name="chief[{$i}][name]" value="{$vo.chief_name}">
                          <input type="hidden" name="chief[{$i}][department]" value="{$vo.chief_department}">
                          <input type="hidden" name="chief[{$i}][office]" value="{$vo.chief_office}">
                          <input type="hidden" name="chief[{$i}][id_level]"      value="{$vo.level}">
                          <input type="hidden" name="chief[{$i}][job]"        value="{$vo.job}">
                          <input type="hidden" name="chief[{$i}][grade_total]"      value="{$vo.grade}">
                          <input type="hidden" name="chief[{$i}][grade_leader]" value="{$vo.grade_leader}">
                          <input type="hidden" name="chief[{$i}][grade_last]" value="{$vo.grade_last}">
                          <input type="hidden" name="chief[{$i}][year]" value="{$vo.year}">
                          <input type="hidden" name="chief[{$i}][month]" value="{$vo.month}">
                          <tr class="even pointer">
                          <td class=" ">
                              <label>
                                {$i}
                              </label>
                            </td>
                          <td class=" ">
                              <label>
                                {$vo.chief_id}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.chief_name}
                              </label>
                            </td>
                            
                            <td class=" ">
                              <label>
                                {$vo.chief_department}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.chief_office}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                <switch name="vo.level">
                                <case value="3">科员</case>
                                <case value="4">科长</case>
                                <case value="7">VSE</case>
                                <case value="8">项目经理</case>
                                </switch>
                              </label>
                            </td>
                            <td class=" "  style="text-align:left;">
                              <label>
                                {$vo.job}
                              </label>
                            </td>
                             <td class=" ">
                              <label>
                                {$vo.grade}
                              </label>
                            </td>
                            <td class=" " style="text-align:left;">
                              <label>
                                {$vo.grade_leader}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.grade_last}
                              </label>
                            </td>
                          </tr>
                        </volist>
                        <volist name="data[staff]" id="vo">
                         <input type="hidden" name="staff[{$i}][id_employee]"   value="{$vo.staff_id}">
                          <input type="hidden" name="staff[{$i}][name]" value="{$vo.staff_name}">
                          <input type="hidden" name="staff[{$i}][department]" value="{$vo.staff_department}">
                          <input type="hidden" name="staff[{$i}][office]" value="{$vo.staff_office}">
                          <input type="hidden" name="staff[{$i}][id_level]"      value="{$vo.level}">
                          <input type="hidden" name="staff[{$i}][job]"        value="{$vo.job}">
                          <input type="hidden" name="staff[{$i}][grade_total]"      value="{$vo.grade}">
                          <input type="hidden" name="staff[{$i}][grade_leader]" value="{$vo.grade_leader}">
                          <input type="hidden" name="staff[{$i}][grade_last]" value="{$vo.grade_last}">
                          <input type="hidden" name="staff[{$i}][year]" value="{$vo.year}">
                          <input type="hidden" name="staff[{$i}][month]" value="{$vo.month}">
                          <tr class="even pointer">
                          <td class=" ">
                              <label>
                                {$i}
                              </label>
                            </td>
                          <td class=" ">
                              <label>
                                {$vo.staff_id}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.staff_name}
                              </label>
                            </td>
                            
                            <td class=" ">
                              <label>
                                {$vo.staff_department}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.staff_office}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                <switch name="vo.level">
                                <case value="3">科员</case>
                                <case value="4">科长</case>
                                <case value="7">VSE</case>
                                <case value="8">项目经理</case>
                                </switch>
                              </label>
                            </td>
                            <td class=" "  style="text-align:left;">
                              <label>
                                {$vo.job}
                              </label>
                            </td>
                             <td class=" ">
                              <label>
                                {$vo.grade}
                              </label>
                            </td>
                            <td class=" " style="text-align:left;">
                              <label>
                                {$vo.grade_leader}
                              </label>
                            </td>
                            <td class=" ">
                              <label>
                                {$vo.grade_last}
                              </label>
                            </td>
                          </tr>
                        </volist>
                        </tbody>
                        </else>
                        </notempty>
                      </table>
                      <empty name="id">

                      <input class="btn btn-success" type="button" value="提交最终版成绩" id="bu" onclick="fom()" style="margin-left:30%;width:10%;">
                      <else/>
                      <a class="btn btn-success" onclick="return confirm('已提交过该月最终成绩！')" style="margin-left:30%;width:10%;">提交最终版成绩</a>
                      </else>
                      </empty>
                      
                      <a class="btn btn-success" href="{:U('Performance/GradesubmissionM')}" style="margin-left:10%;width:10%;">返回</a>
                    </div>
                    </div></div></div></div></div></form></div>


<include file="Public/foot" /> 
 <script src="__PUBLIC__/vendors/Chart.js/dist/Chart.min.js"></script>
 <script src="__PUBLIC__/vendors/gauge.js/dist/gauge.min.js"></script>
<script type="text/javascript">
  function fom(){
    document.getElementById("bu").disabled = "disabled";
    if (confirm("确定要提交？提交后无法更改.")) 
    {  
      document.getElementById("bu").disabled = "disabled";
      $.ajax({
                cache: true,
                type: "POST",
                url:"/TOPNew/Performance/daihao1",
                data:$('#subform').serialize(),// 你的formid
                async: false,
                error: function(request) {
                    alert("Connection error");
                    window.location.reload();
                },
                success: function(data) {
                    if(data.success==1){
                    alert('提交成功!');
                    window.location.reload();
                  }
                }
            });
    }
  }
</script>
<!-- Doughnut Chart -->
    <script>
      $(document).ready(function() {
        var options = {
          legend: false,
          responsive: false
        };

        new Chart(document.getElementById("canvas1"), {
          type: 'doughnut',
          tooltipFillColor: "rgba(51, 51, 51, 0.55)",
          data: {
            labels: [
              "Symbian",
              "Blackberry",
              "Other",
              "Android",
              "IOS"
            ],
            datasets: [{
              data: [15, 20, 30, 10, 30],
              backgroundColor: [
                "#BDC3C7",
                "#9B59B6",
                "#E74C3C",
                "#26B99A",
                "#3498DB"
              ],
              hoverBackgroundColor: [
                "#CFD4D8",
                "#B370CF",
                "#E95E4F",
                "#36CAAB",
                "#49A9EA"
              ]
            }]
          },
          options: options
        });
      });
    </script>
    <!-- /Doughnut Chart -->
    <!-- gauge.js -->
    <script>
      var opts = {
        lines: 12,
        angle: 0,
        lineWidth: 0.4,
        pointer: {
          length: 0.75,
          strokeWidth: 0.042,
          color: '#1D212A'
        },
        limitMax: 'false',
        colorStart: '#1ABC9C',
        colorStop: '#1ABC9C',
        strokeColor: '#F0F3F3',
        generateGradient: true
      };
      var count=document.getElementById('count').value;
      var target = document.getElementById('foo'),
          gauge = new Gauge(target).setOptions(opts);

      gauge.maxValue = 100;
      gauge.animationSpeed = 3;
      gauge.set(count);
      //gauge.setTextField(document.getElementById("gauge-text"));
    </script>
    <!-- /gauge.js -->